<% content_for(:page_title, "Dashboard") %>

<div class="row">
  <div class="col-12">
    <h1>LittleSis Dashboard</h1>
  </div>
  <% if notice %>
    <div class="col-6">
      <div class="alert alert-success"><%= notice %></div>
    </div>
  <% end %>
</div>


<div class="row">
  <div class="col-6">
    <% if current_user.sign_in_count < 10 %>
      <%= dismissable_alert('dashboard_alert') do %>
	Need help using LittleSis? Visit our <%= link_to 'help pages', '/help' %>.
      <% end %>
    <% end %>

    <h4>Search:</h4>
    <div class="w-75">
      <%= render partial: 'dashboard_search' %>
    </div>

    <h4 class="mt-2">Explore:</h4>
    <%= render partial: 'dashboard_explore' %>

    <h4 class="mt-2">Your Recent Edits</h4>
    <div id="dashboard-your-edits">
      <% @recent_updates.each do |entity| %>
	<div class="dashboard-entity">
	  <span class="dashboard-entity-link"><%= entity_link(entity) %></span> &nbsp;<em><%= highlight((entity.blurb or ""), params[:q]) %></em>
	</div>
      <% end %>
    </div>

    <% if @lists.present? %>
      <div id="dashboard-your-lists">
      <h4 class="dashboard-title-link mt-2"><%= link_to 'Your Lists:', home_lists_path %></h4>
      	<div id="dashboard-lists-links" class="m-bottom-1em">
	  <% @lists.each do |list| %>
	    <%= list_link(list) %><br />
	  <% end %>
	</div>
	<%= paginate @lists, param_name: 'list_page' %>
    <% end %>
      </div>
  </div> <%# End Left Column %>

  <div class="col-6">
    <div id="dashboard-bulletins">
      <%= cache ['home_dashboard_bulletins', DashboardBulletin.last_bulletin_updated_at ] do %>
	<%= render partial: 'dashboard_bulletins/bulletins' %>
      <% end %>
    </div>
  </div>
    
</div>


<div class="row mt-4" id="dashboard-maps-row">
  <div class="col-sm-12 nopadding">
    <h3 class="dashboard-title-link">
      <%= link_to 'Your Maps', home_maps_path %>
    </h3>

    <div id="dashboard-maps-container">
      <%= render partial: 'dashboard_map', collection: @maps, as: :map %>
    </div>
    <%= paginate @maps, param_name: 'map_page' %>
  </div>
</div>
