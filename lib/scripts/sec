#!/usr/bin/env -S rails runner
# frozen_string_literal: true

options = {}

OptionParser.new do |opts|
  opts.banner = 'Usage: --cik [CIK NUMBER] [options]'

  opts.on('-c', '--cik=CIK', "The company's CIK number")
  opts.on('--forms [FORMS]', Array, 'comma separated list of forms')
  opts.on('-p', '--print', 'output list of forms')
  opts.on('--database [DATABASE]', 'path to sec filings database')
end.parse!(into: options)

raise OptionParser::MissingArgument.new('CIK') if options[:cik].nil?

db = Sec::FilingsDb.new options.slice(:forms, :database)

if options[:print]
  Sec::FilingsDb.print(db.filings_for(options[:cik]),
                       %w[form_type date_filed filename])
end

db.close
